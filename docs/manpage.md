<!--                          DO NOT EDIT THIS FILE                          -->

<!--

https://jeromebelleman.gitlab.io/posts/publishing/manpages/

*   How to see this in `docker`:

    ```
    bash -xv /usr/local/bin/docker_test
    man git_delete_stale_branches
    ```

-->

% git_delete_stale_branches(1)
% Felipe M. Vieira
% August 2023

# NAME

git_delete_stale_branches â€“ Safely delete your version controlled branches.

# SYNOPSIS

**git_delete_stale_branches** **\--delete** **\--git-directory** git_directory **\--config-directory** config_directory

# DESCRIPTION

**git_delete_stale_branches** safely deletes your version controlled branches. It allows one to version control branches that are not necessary anymore and delete these checked out branches safely in another machine. Imagine that you are developing a branch on a machine A and on a machine B. What happens when you merge that branch or simply want to delete it? Will you remember which branches are ok to delete when you use machine B? Or what happens if you try to sync deleted branches from git when checked out on a branch that needs deletion? This is where **git_delete_stale_branches** steps in.

[See how it is used here](https://github.com/fmv1992/git_delete_stale_branches/blob/8b077a6370d282a789853ebc29a680465eb25e89/makefile#L150):

```
git_delete_stale_branches --delete --git-directory . --config-directory ./other/git/branches
```

## Relevant files

*   `official` file: a single line file containing the name of the main branch. This branch shall never be deleted.

    Example:

    ```
    main
    ```

    Example in Github: <https://github.com/fmv1992/git_delete_stale_branches/blob/main/other/git/branches/official#L1>.

*   `deleted` file: a CSV with 3 fields: `timestamp_delete_if_commit_is_older,branch,timestamp_delete_after` where:

    *   `timestamp_delete_if_commit_is_older`: a unix timestamp registering the time of the intention of deletion. If there's a commit on `branch` that comes after this, it will not be deleted.

    *   `branch`: the branch to be deleted.

    *   `timestamp_delete_after`: a unix timestamp "scheduling" a time for deletion. Use zero (or leave empty) if you want it to be deleted right away. Use `date --date 'now + 7 days' '+%s'` for the deletion to happen only next week.

    For vim users, `inoreabbrev nows <C-R>=strftime("%s")<CR>` and `inoreabbrev nextweek <C-R>=system("date --date 'now + 7 days + 10 seconds' '+%s'")[:-2]<CR>` might come in handy.

    Example:

    ```
    timestamp_delete_if_commit_is_older,branch,timestamp_delete_after
    1739817094,nojira_81,1741366313
    1739817095,feature_branch_1,1741366314
    1739817096,bugfix_123,1741366315
    ```

    Example in Github: <https://github.com/fmv1992/git_delete_stale_branches/blob/main/other/test/test_library/csv_valid_02.csv#L1>.

## Recommended usage

One can create the necessary files like so:

```
[[ -d ./.git ]] \
    && mkdir -p other/git/branches/ \
    && touch other/git/branches/{deleted,official}
```

# GENERAL OPTIONS

**-c**, **\--config-directory**
:   Specify the config directory. This directory must hold the `official` and `deletes` files.

**-g**, **\--git-directory**
:   Specify the git root directory that will have its branches deleted.

**-d**, **\--delete**
:   This flag is spurious but ensures that the user is aware that deletions will occur.

<!--                          DO NOT EDIT THIS FILE                          -->
